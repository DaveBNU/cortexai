# Vulnerability Tracking

Comprehensive vulnerability management and tracking throughout penetration testing engagements.

## Overview

CortexAI provides sophisticated vulnerability tracking with automatic detection, evidence linking, status management, and comprehensive documentation capabilities.

## Vulnerability Lifecycle

### Detection

**Automatic Detection**:
- Pattern recognition in responses
- Tool output parsing
- Error message analysis
- Security header checks

**Manual Logging**:
- User-identified issues
- Complex vulnerabilities
- Business logic flaws
- Manual test results

**AI-Assisted**:
- GPT-4 powered analysis
- Context-aware detection
- False positive filtering
- Severity assessment

### Documentation

Each vulnerability includes:
- **Title**: Brief descriptive name
- **Description**: Detailed explanation
- **Severity**: Critical/High/Medium/Low/Info
- **CWE ID**: Common Weakness Enumeration
- **OWASP Category**: Industry classification
- **URL**: Affected endpoint
- **Parameter**: Vulnerable parameter
- **Payload**: Exploit used
- **Evidence**: Supporting proof
- **Remediation**: Fix recommendations
- **Status**: Current state

### Status Tracking

**Vulnerability States**:
- **New**: Freshly discovered
- **Confirmed**: Verified and validated
- **False Positive**: Not a real vulnerability
- **Remediated**: Fixed by target
- **Risk Accepted**: Acknowledged but not fixed
- **Retest Required**: Needs verification

## Logging Vulnerabilities

### Automatic Logging

CortexAI automatically detects and logs:

**SQL Injection**:
- Database error patterns
- SQL syntax in errors
- Timing-based indicators
- Boolean-based signals

**Cross-Site Scripting (XSS)**:
- Reflected input without encoding
- Stored XSS indicators
- DOM-based XSS patterns
- Script execution context

**Information Disclosure**:
- Error messages with sensitive data
- Stack traces
- Debug information
- Configuration exposure
- API keys and credentials

**Security Headers**:
- Missing CSP
- Lack of HSTS
- Missing X-Frame-Options
- Other header issues

### Manual Logging

Log vulnerabilities manually:

```
> "Log SQL injection vulnerability in login form"
> "Record XSS finding in search parameter"
> "Document authentication bypass in admin panel"
```

**Detailed Logging**:
```
> "Log vulnerability:
Title: SQL Injection in User Search
Severity: High
CWE: CWE-89
OWASP: A03:2021 - Injection
URL: https://example.com/search
Parameter: query
Payload: ' OR '1'='1
Evidence: Database error: mysql_fetch_array() expects parameter 1
Remediation: Use prepared statements for all database queries"
```

## Vulnerability Properties

### Severity Levels

**Critical**:
- Remote code execution
- Full system compromise
- Complete data breach
- Authentication bypass (admin)

**High**:
- SQL injection
- Significant data exposure
- Privilege escalation
- Stored XSS

**Medium**:
- Reflected XSS
- Information disclosure
- CSRF on sensitive functions
- Insecure configurations

**Low**:
- Minor information leaks
- Non-sensitive CSRF
- Verbose error messages
- Missing best practices

**Informational**:
- Technology fingerprinting
- Version disclosure
- Non-exploitable findings
- Recommendations

### CWE Classification

Common Weakness Enumeration IDs:

**Top CWEs**:
- CWE-89: SQL Injection
- CWE-79: Cross-Site Scripting
- CWE-78: OS Command Injection
- CWE-862: Missing Authorization
- CWE-863: Incorrect Authorization
- CWE-200: Information Exposure
- CWE-352: CSRF
- CWE-798: Hard-coded Credentials

### OWASP Categories

OWASP Top 10 classifications:

**OWASP 2021**:
- A01:2021 - Broken Access Control
- A02:2021 - Cryptographic Failures
- A03:2021 - Injection
- A04:2021 - Insecure Design
- A05:2021 - Security Misconfiguration
- A06:2021 - Vulnerable Components
- A07:2021 - Authentication Failures
- A08:2021 - Software and Data Integrity
- A09:2021 - Security Logging Failures
- A10:2021 - Server-Side Request Forgery

## Managing Vulnerabilities

### Viewing Vulnerabilities

List all findings:

```
> "Show all vulnerabilities"
> "List high severity findings"
> "Display new vulnerabilities"
```

**Filtered Views**:
```
> "Show SQL injection vulnerabilities"
> "List vulnerabilities in /admin path"
> "Display vulnerabilities by severity"
```

### Updating Status

Change vulnerability status:

```
> "Mark vulnerability 5 as confirmed"
> "Update vulnerability 12 to false positive"
> "Set vulnerability 8 to remediated"
```

**With Notes**:
```
> "Mark vulnerability 5 as confirmed - Verified with manual testing"
> "Update vulnerability 12 to false positive - WAF blocking legitimate requests"
```

### Adding Evidence

Link additional evidence:

```
> "Add evidence to vulnerability 5"
> "Store HTTP request/response for vulnerability 12"
> "Attach screenshot to vulnerability 8"
```

### Updating Details

Modify vulnerability information:

```
> "Update vulnerability 5 severity to Critical"
> "Change vulnerability 12 title to 'Reflected XSS in Search'"
> "Add remediation advice to vulnerability 8"
```

## Evidence Management

### HTTP Evidence

Automatically capture HTTP transactions:

**Captured Data**:
- Request method and URL
- Request headers
- Request body/parameters
- Response status code
- Response headers
- Response body
- Timestamp

**Viewing Evidence**:
```
> "Show evidence for vulnerability 5"
> "Display HTTP request for XSS finding"
> "View full response for SQL injection"
```

### Tool Output

Store tool results as evidence:

**Supported Outputs**:
- Nmap scan results
- SQLMap output
- Burp Suite findings
- Custom script results

**Attaching Outputs**:
```
> "Store nmap output as evidence for vulnerability 10"
> "Attach SQLMap results to SQL injection finding"
```

### Screenshots

Document visual proof:

```
> "Attach screenshot to XSS vulnerability"
> "Add visual evidence to vulnerability 15"
```

## Reporting Features

### Vulnerability Summaries

Generate reports:

```
> "Generate vulnerability summary report"
> "Create executive summary of findings"
> "Export vulnerabilities by severity"
```

### Detailed Reports

Comprehensive vulnerability documentation:

```
> "Generate detailed report for vulnerability 5"
> "Create technical writeup for all high severity findings"
```

### Export Formats

**JSON Export**:
```
> "Export vulnerabilities to JSON"
```

**CSV Export**:
```
> "Export vulnerability list to CSV"
```

**Markdown Export**:
```
> "Generate markdown report of findings"
```

## Best Practices

### Thorough Documentation

**Complete Information**:
- Clear, descriptive titles
- Detailed descriptions
- Step-by-step reproduction
- Actual command outputs
- Impact assessment
- Specific remediation advice

### Accurate Severity

**Proper Classification**:
- Consider exploitability
- Assess actual impact
- Factor in mitigations
- Account for context
- Follow CVSS guidelines

### Evidence Collection

**Comprehensive Proof**:
- Capture requests and responses
- Save tool outputs
- Take screenshots
- Document payloads
- Record timestamps

### Verification

**Confirm Findings**:
- Manually verify detections
- Test with multiple methods
- Rule out false positives
- Document verification steps

## Vulnerability Examples

### SQL Injection

```
Title: SQL Injection in Login Form
Severity: High
CWE: CWE-89
OWASP: A03:2021 - Injection
URL: https://example.com/login
Parameter: username
Payload: admin' OR '1'='1'--
Impact: Bypass authentication, access user data
Evidence: Database error exposed in response
Remediation: Use parameterized queries
Status: Confirmed
```

### Cross-Site Scripting

```
Title: Reflected XSS in Search Function
Severity: Medium
CWE: CWE-79
OWASP: A03:2021 - Injection
URL: https://example.com/search
Parameter: q
Payload: <script>alert('XSS')</script>
Impact: Session hijacking, credential theft
Evidence: Payload executed in browser
Remediation: Sanitize input, encode output
Status: New
```

### Authentication Bypass

```
Title: Authentication Bypass via Parameter Tampering
Severity: Critical
CWE: CWE-862
OWASP: A01:2021 - Broken Access Control
URL: https://example.com/admin
Parameter: isAdmin
Payload: isAdmin=true in cookie
Impact: Unauthorized admin access
Evidence: Full admin panel access achieved
Remediation: Server-side authorization checks
Status: Confirmed
```

## Tracking Progress

### Testing Coverage

Monitor testing completeness:

```
> "Show testing coverage statistics"
> "Display tested vs untested assets"
> "List untested functionality"
```

### Retesting

Track remediation verification:

```
> "List vulnerabilities needing retest"
> "Show remediated findings for verification"
```

### Status Dashboard

Overview of engagement status:

```
> "Show vulnerability dashboard"
> "Display summary by status"
> "Generate progress report"
```

## Collaboration Features

### Sharing Findings

Share with team members:

```
> "Export vulnerability 5 for team review"
> "Generate shareable finding report"
```

### Notes and Comments

Add contextual information:

```
> "Add note to vulnerability 5: Client confirmed issue"
> "Comment on vulnerability 12: Similar to finding in previous test"
```

## Troubleshooting

### False Positive Management

**Identifying False Positives**:
- Manual verification
- Context analysis
- Multiple test methods
- Tool cross-validation

**Marking False Positives**:
```
> "Mark vulnerability 12 as false positive"
> "Add explanation: WAF detection, not actual vulnerability"
```

### Duplicate Findings

**Handling Duplicates**:
- Review similar findings
- Merge duplicates
- Link related issues
- Maintain references

### Missing Evidence

**Adding Missing Evidence**:
```
> "Add evidence to vulnerability 5"
> "Capture HTTP transaction for XSS"
> "Store additional proof for finding"
```

## Advanced Features

### Bulk Operations

Manage multiple vulnerabilities:

```
> "Update all new vulnerabilities to confirmed"
> "Export all high severity findings"
> "Tag all XSS vulnerabilities"
```

### Custom Fields

Add custom metadata:

```
> "Add custom field 'client_severity' to vulnerability"
> "Set business_impact for high severity findings"
```

### Vulnerability Templates

Create reusable templates:

```
> "Save SQL injection template"
> "Use XSS template for new finding"
```

## Next Steps

Related documentation:

- **Evidence Collection**: [Evidence Collection Guide](evidence-collection.md)
- **Security Testing**: [Security Testing Guide](../security-testing/web-application.md)
- **Reporting**: [Best Practices](../user-guide/best-practices.md)

## Getting Help

For vulnerability tracking assistance:

- **FAQ**: [Frequently Asked Questions](../troubleshooting/faq.md)
- **Database Schema**: [Database Schema Reference](../reference/database-schema.md)
- **GitHub**: [Report Issues](https://github.com/theelderemo/cortexai/issues)

---

**Remember**: Accurate vulnerability tracking is essential for effective penetration testing and client communication.
